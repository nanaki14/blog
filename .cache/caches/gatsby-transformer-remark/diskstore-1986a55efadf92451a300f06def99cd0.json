{"expireTime":9007200819756203000,"key":"transformer-remark-markdown-html-1d673484e8079af33afc6cd002e061aa-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":"<p>こんにちわ、ななきです。</p>\n<p>最近GAとかGTMに苦しめられてます。</p>\n<p>特にReactでhelmetを使ったtitleの変更後にGAやGTMに情報を伝える場合に反映前のものや、遷移前のページのものが伝わることがありました。</p>\n<p>多分Vueでも同様な事が起こると思うので、メモ代わりに対応方法残しておきます。</p>\n<h2>setTimeout</h2>\n<p>いろんなライフサイクルや状態の変更後に <code class=\"language-text\">dataLayer.push</code> を試したのですがうまくいかず調べてたどり着いたのが <code class=\"language-text\">setTimeout</code> でした。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">setTimeout(() =&gt; {\n  dataLayer.push({ event: &#39;custom-name&#39; })\n}, 0)</code></pre></div>\n<p>こんなかんじで <code class=\"language-text\">componentDidMount</code> や <code class=\"language-text\">componentWillReceiveProps</code> などの中で発火させると正しく変更後・遷移後のtitleを渡すことが出来ました。</p>\n<p>あまりスマートな解決策では無いかもしれませんが、issue内でも他の方法が上がっておらず一旦この形で乗り切るしかなさそうですね。</p>\n<p>余談ですが、このコードを書いたときに、昔上司に <code class=\"language-text\">setTimeout</code> は魔法だからうまく行かなかったら試してみなさいと言われたのを思い出したました。</p>"}