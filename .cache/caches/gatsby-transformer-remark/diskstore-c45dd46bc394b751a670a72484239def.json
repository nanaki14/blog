{"expireTime":9007200819756549000,"key":"transformer-remark-markdown-html-ast-3d95dcdaa661a90fadb40bf704bad398-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"こんにちわ、ななきです。","position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":13,"offset":12}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":13,"offset":12}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"だいぶ前にVueをTypeScript化した的な記事書いたのですが、それから案件でもTS化したVueを使っていたのと最近の界隈の流れもありNuxtもTypeScript化してみました。","position":{"start":{"line":3,"column":1,"offset":14},"end":{"line":3,"column":93,"offset":106}}}],"position":{"start":{"line":3,"column":1,"offset":14},"end":{"line":3,"column":93,"offset":106}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"結果的にデコレータを使わずに、vuexもコンポーネントも型が効いており満足です。","position":{"start":{"line":5,"column":1,"offset":108},"end":{"line":5,"column":41,"offset":148}}}],"position":{"start":{"line":5,"column":1,"offset":108},"end":{"line":5,"column":41,"offset":148}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ちなみにvuex部分にかんしては","position":{"start":{"line":7,"column":1,"offset":150},"end":{"line":7,"column":17,"offset":166}}},{"type":"raw","value":"<a href=\"https://github.com/takefumi-yoshii/ts-nuxtjs-express\" target=\"_blank\">","position":{"start":{"line":7,"column":17,"offset":166},"end":{"line":7,"column":96,"offset":245}}},{"type":"text","value":"こちら","position":{"start":{"line":7,"column":96,"offset":245},"end":{"line":7,"column":99,"offset":248}}},{"type":"raw","value":"</a>","position":{"start":{"line":7,"column":99,"offset":248},"end":{"line":7,"column":103,"offset":252}}},{"type":"text","value":"のリポジトリを参考にさせて頂きました。","position":{"start":{"line":7,"column":103,"offset":252},"end":{"line":7,"column":122,"offset":271}}}],"position":{"start":{"line":7,"column":1,"offset":150},"end":{"line":7,"column":122,"offset":271}}},{"type":"text","value":"\n"},{"type":"raw","value":"<h2>コンポーネントのTS化</h2>","position":{"start":{"line":9,"column":1,"offset":273},"end":{"line":9,"column":21,"offset":293}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"コンポーネントに関してはびっくりするほどやることないです。","position":{"start":{"line":11,"column":1,"offset":295},"end":{"line":11,"column":30,"offset":324}}}],"position":{"start":{"line":11,"column":1,"offset":295},"end":{"line":11,"column":30,"offset":324}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ yarn add ts-node\n$ yarn add -D @nuxt/typescript\n$ touch tsconfig.json\n$ nuxt build</code></pre></div>","position":{"start":{"line":13,"column":1,"offset":326},"end":{"line":18,"column":4,"offset":418}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"これだけです、あとはコンポーネント内で以下の様に書いて行けばいいだけです。","position":{"start":{"line":20,"column":1,"offset":420},"end":{"line":20,"column":38,"offset":457}}}],"position":{"start":{"line":20,"column":1,"offset":420},"end":{"line":20,"column":38,"offset":457}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;script lang=&quot;ts&quot;&gt;\nimport Vue from &#39;vue&#39;\n\nexport default Vue.extend({\n  // ここにいつものライフサイクル\n})\n&lt;/script&gt;</code></pre></div>","position":{"start":{"line":22,"column":1,"offset":459},"end":{"line":30,"column":4,"offset":569}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"最初のうちはめんどくさいtsconfigすらもbuild時に記述してくれるのですごいです。","position":{"start":{"line":32,"column":1,"offset":571},"end":{"line":32,"column":46,"offset":616}}}],"position":{"start":{"line":32,"column":1,"offset":571},"end":{"line":32,"column":46,"offset":616}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"そしてTS化すると気になるのがlintですよね。","position":{"start":{"line":34,"column":1,"offset":618},"end":{"line":34,"column":25,"offset":642}}}],"position":{"start":{"line":34,"column":1,"offset":618},"end":{"line":34,"column":25,"offset":642}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nuxtのeslintは優秀なので可能な限りそのまま使いたいので以下の様に拡張します。","position":{"start":{"line":36,"column":1,"offset":644},"end":{"line":36,"column":44,"offset":687}}}],"position":{"start":{"line":36,"column":1,"offset":644},"end":{"line":36,"column":44,"offset":687}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ yarn add -D @typescript-eslint/eslint-plugin</code></pre></div>","position":{"start":{"line":38,"column":1,"offset":689},"end":{"line":40,"column":4,"offset":743}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">module.exports = {\n  // ここまでデフォルトの設定\n\n  parserOptions: {\n    parser: &#39;@typescript-eslint/parser&#39;\n  },\n}</code></pre></div>","position":{"start":{"line":42,"column":1,"offset":745},"end":{"line":50,"column":4,"offset":856}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"これでeslintでもTSをパースできる様になりました。","position":{"start":{"line":52,"column":1,"offset":858},"end":{"line":52,"column":29,"offset":886}}}],"position":{"start":{"line":52,"column":1,"offset":858},"end":{"line":52,"column":29,"offset":886}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"とても簡単です。","position":{"start":{"line":54,"column":1,"offset":888},"end":{"line":54,"column":9,"offset":896}}}],"position":{"start":{"line":54,"column":1,"offset":888},"end":{"line":54,"column":9,"offset":896}}},{"type":"text","value":"\n"},{"type":"raw","value":"<h2>vuexのTS化</h2>","position":{"start":{"line":56,"column":1,"offset":898},"end":{"line":56,"column":18,"offset":915}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"こちらに関しては冒頭で紹介したリポジトリの","position":{"start":{"line":58,"column":1,"offset":917},"end":{"line":58,"column":22,"offset":938}}},{"type":"raw","value":"<a href=\"https://github.com/takefumi-yoshii/ts-nuxtjs-express/tree/master/types/vuex\" target=\"_blank\">","position":{"start":{"line":58,"column":22,"offset":938},"end":{"line":58,"column":124,"offset":1040}}},{"type":"text","value":"/types/vuex","position":{"start":{"line":58,"column":124,"offset":1040},"end":{"line":58,"column":135,"offset":1051}}},{"type":"raw","value":"</a>","position":{"start":{"line":58,"column":135,"offset":1051},"end":{"line":58,"column":139,"offset":1055}}},{"type":"text","value":"を使わせてもらいました。","position":{"start":{"line":58,"column":139,"offset":1055},"end":{"line":58,"column":151,"offset":1067}}}],"position":{"start":{"line":58,"column":1,"offset":917},"end":{"line":58,"column":151,"offset":1067}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"その上でコンポーネント内でも型を効かせたいが、デコレーターは使いたくなかったので型のプラグインを作成しました。","position":{"start":{"line":60,"column":1,"offset":1069},"end":{"line":60,"column":56,"offset":1124}}}],"position":{"start":{"line":60,"column":1,"offset":1069},"end":{"line":60,"column":56,"offset":1124}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"plugins/exstore/index.ts\"><pre class=\"language-plugins/exstore/index.ts\"><code class=\"language-plugins/exstore/index.ts\">import * as Vuex from &#39;vuex&#39;\n\nclass ExStore {\n  store: Vuex.ExStore\n  constructor(store) {\n    this.store = store\n  }\n\n  getStore() {\n    return this.store\n  }\n\n  state() {\n    return this.store.state\n  }\n\n  getters() {\n    return this.store.getters\n  }\n\n  commit() {\n    return this.store.commit\n  }\n\n  dispatch() {\n    return this.store.dispatch\n  }\n}\n\nexport default (context, inject) =&gt; {\n  const store = new ExStore(context.store)\n\n  inject(&#39;exStore&#39;, store.getStore())\n  inject(&#39;state&#39;, store.state())\n  inject(&#39;getters&#39;, store.getters())\n  inject(&#39;commit&#39;, store.commit())\n  inject(&#39;dispatch&#39;, store.dispatch())\n}</code></pre></div>","position":{"start":{"line":62,"column":1,"offset":1126},"end":{"line":101,"column":4,"offset":1778}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"今度はこのプラグインを注入します。","position":{"start":{"line":103,"column":1,"offset":1780},"end":{"line":103,"column":18,"offset":1797}}}],"position":{"start":{"line":103,"column":1,"offset":1780},"end":{"line":103,"column":18,"offset":1797}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"nuxt.config.js\"><pre class=\"language-nuxt.config.js\"><code class=\"language-nuxt.config.js\">plugins: [\n  {\n    src: &#39;~/plugins/exStore&#39;,\n    ssr: true\n  }\n],</code></pre></div>","position":{"start":{"line":105,"column":1,"offset":1799},"end":{"line":112,"column":4,"offset":1886}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"これでコンポーネント内で下記の様にstoreのオブジェクトへアクセスできるようになります。","position":{"start":{"line":114,"column":1,"offset":1888},"end":{"line":114,"column":46,"offset":1933}}}],"position":{"start":{"line":114,"column":1,"offset":1888},"end":{"line":114,"column":46,"offset":1933}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">// store\nthis.$state.exStore\n\n// state\nthis.$state\n\n// getters\nthis.$getters[&#39;hoge/fuga&#39;]\n\n// commit\nthis.$commit[&#39;hoge/fuga&#39;]\n\n// dispatch\nthis.$dispatch[&#39;hoge/fuga&#39;]</code></pre></div>","position":{"start":{"line":116,"column":1,"offset":1935},"end":{"line":131,"column":4,"offset":2110}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"なぜわざわざプラグインを作ったのは","position":{"start":{"line":133,"column":1,"offset":2112},"end":{"line":133,"column":18,"offset":2129}}},{"type":"raw","value":"<code class=\"language-text\">$store</code>","position":{"start":{"line":133,"column":18,"offset":2129},"end":{"line":133,"column":26,"offset":2137}}},{"type":"text","value":"が","position":{"start":{"line":133,"column":26,"offset":2137},"end":{"line":133,"column":27,"offset":2138}}},{"type":"raw","value":"<code class=\"language-text\">$store: Vuex.Store&lt;any&gt;</code>","position":{"start":{"line":133,"column":27,"offset":2138},"end":{"line":133,"column":52,"offset":2163}}},{"type":"text","value":"で固定されており書き換えが出来なかったためです。","position":{"start":{"line":133,"column":52,"offset":2163},"end":{"line":133,"column":76,"offset":2187}}}],"position":{"start":{"line":133,"column":1,"offset":2112},"end":{"line":133,"column":76,"offset":2187}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ので型定義ファイルに下記の追加をしていきます。","position":{"start":{"line":135,"column":1,"offset":2189},"end":{"line":135,"column":24,"offset":2212}}}],"position":{"start":{"line":135,"column":1,"offset":2189},"end":{"line":135,"column":24,"offset":2212}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"types/nuxt/vue.d.ts\"><pre class=\"language-types/nuxt/vue.d.ts\"><code class=\"language-types/nuxt/vue.d.ts\">import Vue from &#39;vue&#39;\nimport * as Vuex from &#39;vuex&#39;\n\ndeclare module &#39;vue/types/vue&#39; {\n  interface Vue {\n    $exStore: Vuex.ExStore\n    $state: Vuex.ExStore[&#39;state&#39;]\n    $getters: Vuex.ExStore[&#39;getters&#39;]\n    $commit: Vuex.ExStore[&#39;commit&#39;]\n    $dispatch: Vuex.ExStore[&#39;dispatch&#39;]\n  }\n}</code></pre></div>","position":{"start":{"line":137,"column":1,"offset":2214},"end":{"line":150,"column":4,"offset":2524}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"こうすることでcontextを参照できる場所でのvuexの型が効くようになりました。","position":{"start":{"line":152,"column":1,"offset":2526},"end":{"line":152,"column":43,"offset":2568}}}],"position":{"start":{"line":152,"column":1,"offset":2526},"end":{"line":152,"column":43,"offset":2568}}},{"type":"text","value":"\n"},{"type":"raw","value":"<h2>まとめ</h2>","position":{"start":{"line":154,"column":1,"offset":2570},"end":{"line":154,"column":13,"offset":2582}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"コンポーネントだけであれば簡単にTS化できるので軽い気持ちで触ってみるのもいいと思います。","position":{"start":{"line":156,"column":1,"offset":2584},"end":{"line":156,"column":46,"offset":2629}}}],"position":{"start":{"line":156,"column":1,"offset":2584},"end":{"line":156,"column":46,"offset":2629}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ただvuexの型が効くとほんとに世界変わるので是非慣れてきたら使ってみてください。","position":{"start":{"line":158,"column":1,"offset":2631},"end":{"line":158,"column":42,"offset":2672}}}],"position":{"start":{"line":158,"column":1,"offset":2631},"end":{"line":158,"column":42,"offset":2672}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":158,"column":42,"offset":2672}}}}